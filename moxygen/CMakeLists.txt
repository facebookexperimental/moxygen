# Copyright (c) Meta Platforms, Inc. and affiliates.
# All rights reserved.
#
# This source code is licensed under the BSD-style license found in the
# LICENSE file in the root directory of this source tree.

# Auto-generated by generate_cmake.py - DO NOT EDIT MANUALLY

moxygen_add_library(moxygen_moq_versions
  SRCS
    MoQVersions.cpp
  EXPORTED_DEPS
    Folly::folly_conv
    Folly::folly_string
)

moxygen_add_library(moxygen_moq_types
  SRCS
    MoQTypes.cpp
  EXPORTED_DEPS
    Folly::folly_container_f14_hash
    Folly::folly_conv
    Folly::folly_expected
    Folly::folly_hash_hash
    Folly::folly_io_iobuf
    Folly::folly_logging_logging
    Folly::folly_string
)

moxygen_add_library(moxygen_moq_framer
  SRCS
    MoQFramer.cpp
  EXPORTED_DEPS
    moxygen_moq_token_cache
    moxygen_moq_types
    moxygen_moq_versions
    mvfst::mvfst_codec_types
    mvfst::mvfst_exception
    mvfst::mvfst_folly_utils
    Folly::folly_container_f14_hash
    Folly::folly_io_iobuf
    Folly::folly_lang_bits
    Folly::folly_logging_logging
)

moxygen_add_library(moxygen_moq_codec
  SRCS
    MoQCodec.cpp
  EXPORTED_DEPS
    moxygen_moq_framer
    Folly::folly_logging_logging
)

moxygen_add_library(moxygen_moq_location
  EXPORTED_DEPS
    moxygen_moq_framer
    Folly::folly_logging_logging
)

moxygen_add_library(moxygen_moq
  SRCS
    MoQSession.cpp
  EXPORTED_DEPS
    moxygen_events_moq_delivery_timeout_manager
    moxygen_events_moq_delivery_timer
    moxygen_events_moq_executor
    moxygen_mlog_mlogger
    moxygen_moq_codec
    moxygen_moq_consumers
    moxygen_moq_types
    moxygen_stats_moq_stats
    proxygen::proxygen_http_webtransport
    mvfst::mvfst_common_circular_deque
    mvfst::mvfst_priority_http_priority_queue
    Folly::folly_container_f14_hash
    Folly::folly_coro_collect
    Folly::folly_coro_future_util
    Folly::folly_coro_promise
    Folly::folly_coro_task
    Folly::folly_coro_timeout
    Folly::folly_io_async_async_base
    Folly::folly_logging_logging
    Folly::folly_maybe_managed_ptr
)

moxygen_add_library(moxygen_moq_relay_session
  SRCS
    MoQRelaySession.cpp
  EXPORTED_DEPS
    moxygen_moq
    Folly::folly_container_f14_hash
    Folly::folly_coro_collect
    Folly::folly_coro_future_util
    Folly::folly_cpp_attributes
    Folly::folly_logging_logging
)

moxygen_add_library(moxygen_moq_publish_error)

moxygen_add_library(moxygen_moq_consumers
  EXPORTED_DEPS
    moxygen_moq_publish_error
    moxygen_moq_types
    proxygen::proxygen_http_webtransport
)

moxygen_add_library(moxygen_moq_server
  SRCS
    MoQServer.cpp
    MoQServerBase.cpp
  EXPORTED_DEPS
    moxygen_events_moq_folly_executor_impl
    moxygen_mlog_mlogger_factory
    moxygen_moq
    proxygen::proxygen_hq_server
    proxygen::proxygen_http_session_hq_session
    proxygen::proxygen_http_webtransport_httpwebtransport
    proxygen::proxygen_http_webtransport_quicwebtransport
    Folly::folly_coro_baton
    Folly::folly_init_init
    Folly::folly_io_async_async_base
    Folly::folly_io_async_event_base_manager
    Folly::folly_logging_logging
    Folly::folly_string
)

moxygen_add_library(moxygen_moqclient_base
  SRCS
    MoQClientBase.cpp
  EXPORTED_DEPS
    moxygen_mlog_mlogger
    moxygen_moq
    proxygen::proxygen_http_webtransport
    proxygen::proxygen_http_webtransport_quicwebtransport
    proxygen::proxygen_utils_parse_url
    mvfst::mvfst_client
    mvfst::mvfst_state_transport_settings
    fizz::fizz
    Folly::folly_coro_error
    Folly::folly_coro_promise
    Folly::folly_string
)

moxygen_add_library(moxygen_moqclient
  SRCS
    MoQClient.cpp
  EXPORTED_DEPS
    moxygen_events_moq_folly_executor_impl
    moxygen_moqclient_base
    moxygen_util_quic_connector
    proxygen::proxygen_utils_parse_url
    Folly::folly_coro_task
)

moxygen_add_library(moxygen_moq_webtransport_client
  SRCS
    MoQWebTransportClient.cpp
  EXPORTED_DEPS
    moxygen_events_moq_folly_executor_impl
    moxygen_moq_framer
    moxygen_moqclient
    proxygen::proxygen_http_hq_connector
    proxygen::proxygen_http_session_http_transaction
    proxygen::proxygen_http_session_quic_protocol_info
    proxygen::proxygen_http_webtransport_httpwebtransport
    Folly::folly_string
)

moxygen_add_library(moxygen_moq_token_cache
  SRCS
    MoQTokenCache.cpp
  EXPORTED_DEPS
    Folly::folly_container_f14_hash
    Folly::folly_expected
    Folly::folly_logging_logging
)

moxygen_add_library(moxygen_moq_obj_receiver
  EXPORTED_DEPS
    moxygen_moq_consumers
    Folly::folly_logging_logging
)

moxygen_add_library(moxygen_moq_queue_callback
  EXPORTED_DEPS
    moxygen_moq_obj_receiver
    Folly::folly_coro_unbounded_queue
)

add_subdirectory(dejitter)
add_subdirectory(events)
add_subdirectory(flv_parser)
add_subdirectory(mlog)
add_subdirectory(moq_mi)
add_subdirectory(moq_mi_to_flv)
add_subdirectory(stats)
add_subdirectory(util)

add_subdirectory(relay)

if(BUILD_SAMPLES)
  add_subdirectory(moqtest)
  add_subdirectory(samples)
endif()

if(BUILD_TESTS)
  add_subdirectory(test)
endif()

# Resolve deferred moxygen internal dependencies
moxygen_resolve_deferred_dependencies()
